<div *ngIf="isLoading" class="loading-animation">
  <div class="spinner"></div>
</div>


<div *ngIf="!isLoading">
  <div id="contenerdorCentrador">
    <img src="../../../assets/image/liverpool.jpg" id="logo" alt="Logo Liverpool">
</div>

<div class="container" id="inicio">
<nav class="navbar navbar-dark ">
<div class="container-fluid" style="background-color: #73246D; padding: 1%;">

<div class="" style="padding-top: 2%;">
  <button type="button" class="btn position-relative">
    <a class="" style="color: white;" type="button" data-bs-toggle="offcanvas" data-bs-target="#staticBackdrop" aria-controls="staticBackdrop">
      <svg xmlns="http://www.w3.org/2000/svg" width="34" height="34" fill="currentColor" class="bi bi-envelope" viewBox="0 0 16 16">
        <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4Zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2Zm13 2.383-4.708 2.825L15 11.105V5.383Zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741ZM1 11.105l4.708-2.897L1 5.383v5.722Z"/>
      </svg></a>
    <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger">
      {{emailsAmount}}
    </span>
  </button>
</div>

<!--  <a class="" style="color: white;" type="button" data-bs-toggle="offcanvas" data-bs-target="#staticBackdrop" aria-controls="staticBackdrop">
  <svg xmlns="http://www.w3.org/2000/svg" width="34" height="34" fill="currentColor" class="bi bi-envelope" viewBox="0 0 16 16">
    <path d="M0 4a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V4Zm2-1a1 1 0 0 0-1 1v.217l7 4.2 7-4.2V4a1 1 0 0 0-1-1H2Zm13 2.383-4.708 2.825L15 11.105V5.383Zm-.034 6.876-5.64-3.471L8 9.583l-1.326-.795-5.64 3.47A1 1 0 0 0 2 13h12a1 1 0 0 0 .966-.741ZM1 11.105l4.708-2.897L1 5.383v5.722Z"/>
  </svg></a> -->

<div class="offcanvas offcanvas-start" data-bs-backdrop="static" tabindex="-1" id="staticBackdrop" aria-labelledby="staticBackdropLabel" style="background-color: #c882c2;" >
  <div class="offcanvas-header">
    <h5 class="offcanvas-title" id="staticBackdropLabel" style="color: white;">Bandeja de entrada</h5>
    <button type="button" class="btn-close" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <!--
    background-color: rgba(0, 0, 0, 0.477); 
  -->

  <div class="container">
    <button (click)="deleteAllNotify()" class="container" id="newBtn2">Eliminar notificaciones vistas </button>
    </div>

    <div class="offcanvas-body">
    <div class="container" *ngFor="let item of responseArrayEmails; let i = index">
      <div (click)="getEmailsVRequest(item.id, item.message, item.reinr, item.visibility)" id="divChange2" class="container" style="border-radius: 10px; cursor: pointer;" [style.background-color]="getVisibility(visibility_auth[i]) === 0 ? 'rgba(0, 0, 0, 0.477)' : 'rgba(0, 0, 0, 0.192)'">
      <h5 class="textEmail2" style="color: white;">{{item.title}}</h5>
      <p class="textDetail2" style="color: white;">{{item.subtitle}}</p>
      <div class="container" style="padding: 2%;" [style.display]="notifyDisplay">
        <button (click)="deleteNotify(item.id, $event)" class="btn btn-danger"  style="--bs-btn-padding-y: .25rem; --bs-btn-padding-x: .5rem; --bs-btn-font-size: .75rem;">  <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-trash3-fill" viewBox="0 0 16 16">
          <path d="M11 1.5v1h3.5a.5.5 0 0 1 0 1h-.538l-.853 10.66A2 2 0 0 1 11.115 16h-6.23a2 2 0 0 1-1.994-1.84L2.038 3.5H1.5a.5.5 0 0 1 0-1H5v-1A1.5 1.5 0 0 1 6.5 0h3A1.5 1.5 0 0 1 11 1.5Zm-5 0v1h4v-1a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 0-.5.5ZM4.5 5.029l.5 8.5a.5.5 0 1 0 .998-.06l-.5-8.5a.5.5 0 1 0-.998.06Zm6.53-.528a.5.5 0 0 0-.528.47l-.5 8.5a.5.5 0 0 0 .998.058l.5-8.5a.5.5 0 0 0-.47-.528ZM8 4.5a.5.5 0 0 0-.5.5v8.5a.5.5 0 0 0 1 0V5a.5.5 0 0 0-.5-.5Z"/>
        </svg>Eliminar notificación</button>
      </div>
    </div>
    
    <br>
    
    </div>
</div>
</div>


<ul *ngIf="auth.user$ | async as user">
<a id="userName" class="navbar-brand" style="color: white;">Usuario: {{ user.nickname}}</a>
</ul>
<button class="navbar-toggler" type="button" data-bs-toggle="offcanvas" data-bs-target="#offcanvasDarkNavbar" aria-controls="offcanvasDarkNavbar" aria-label="Toggle navigation" style="color: white; background-color: #F25F29;">
  <span class="navbar-toggler-icon" style="color: white; "></span>
</button>
<div class="offcanvas offcanvas-end" tabindex="-1" id="offcanvasDarkNavbar" aria-labelledby="offcanvasDarkNavbarLabel" style="background-color: #73246D;">
  <div class="offcanvas-header">
    <ul *ngIf="auth.user$ | async as user">
    <img src="{{user.picture}}" alt="{{user.given_name}}" width="40" height="40" class="rounded-circle me-1" title="{{user.name}}">
    <h5 class="offcanvas-title" id="offcanvasDarkNavbarLabel"  style="color: white;">{{ user.name }}</h5>
  </ul>
    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="offcanvas" aria-label="Close"></button>
  </div>
  <div class="offcanvas-body">
    <ul class="navbar-nav justify-content-end flex-grow-1 pe-3">
      <li class="nav-item">
        <a  class="nav-link active" aria-current="page" href="/Viajero/Home">Home</a>
      </li>
      <li class="nav-item">
        <a (click)="user()" class="nav-link" style="cursor: pointer;">Cambiar usuario</a>
      </li>
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="#" role="button" data-bs-toggle="dropdown" aria-expanded="false">
          Filtrar viaje
        </a>
        <ul class="dropdown-menu dropdown-menu-light">
          <li><a class="dropdown-item" href="/Viajero/Filtro/NumeroViaje">Número de viaje</a></li>
            <hr class="dropdown-divider">
          <li><a class="dropdown-item" href="/Viajero/Filtro/Fecha">Fecha</a></li>
          <hr class="dropdown-divider">
        <li><a class="dropdown-item" href="/Viajero/Filtro/Estado">Estado</a></li>
        </ul>
      </li>
    </ul>
  </div>
  <div class="container" style="padding-bottom: 5%;">
    <button (click)="logout()" class="btn btn-lg" type="submit" style="background-color: #F25F29; color: white;" title="cerrar sesión">Cerrar Sesión</button>
  </div>
</div>
</div>
</nav>

</div>  

<div class="text-center" style="margin-top: 1%; padding-bottom: 3px;">
<h2 class="titulo-ext">REGISTRO DE VIAJES</h2>        
</div>


<div class="container" style="padding-bottom: 5%;">
<hr>
<div class="row row-cols-1 row-cols-md-3 g-4">

<div class="col" *ngFor="let item of responseArray; let i = index">
<div class="card">
<img src="../../../assets/image/london.jpg" class="card-img-top" alt="Londres" width="200px" height="200px">
<div class="card-body">
<h5 class="card-title">{{item.zort1}}</h5>
<hr>
<div class="row">
  <div class="col">
    Viaje:
    <input type="text" class="form-control card border-secondary mb-3" [value]="item.reinr" readonly style="border: 1">
  </div>
  <div class="col">
    Tipo:
    <input type="text" class="form-control card border-secondary mb-3" [value]="item.schem" readonly style="border: 1">
  </div>
</div>

<div class="row">
  <div class="col">
    Fecha Salida:
    <input type="text" class="form-control card border-secondary mb-3" [value]="item.datv1" readonly style="border: 1">
  </div>
  <div class="col">
    Hora Salida:
    <input type="text" class="form-control card border-secondary mb-3" [value]="item.uhrv1" readonly style="border: 1">
  </div>
</div>
<hr>
<p class="card-text mb-3 text-center" [style.color]="getEstado(authorized[i]) === 'Aprobado' ? 'green' : (getEstado(authorized[i]) === 'Rechazado' ? 'red' : 'grey')">
  Estado: {{ getEstado(authorized[i]) }}
</p>
<button (click)="sendData(item.id)" class="btn btn-outline-primary">Visualizar</button>
</div>
</div>
</div>

</div>
</div>
</div>



